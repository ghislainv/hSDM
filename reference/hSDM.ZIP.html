<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ZIP (Zero-Inflated Poisson) model — hSDM.ZIP • hSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="ZIP (Zero-Inflated Poisson) model — hSDM.ZIP"><meta property="og:description" content="The hSDM.ZIP function can be used to model species
  distribution including different processes in a hierarchical Bayesian
  framework: a \(\mathcal{B}ernoulli\) suitability process
  (refering to various ecological variables explaining environmental
  suitability or not) and a \(\mathcal{P}oisson\) abundance
  process (refering to various ecological variables explaining the
  species abundance when the habitat is suitable). The hSDM.ZIP
  function calls a Gibbs sampler written in C code which uses a
  Metropolis algorithm to estimate the conditional posterior
  distribution of hierarchical model's parameters."><meta property="og:image" content="https://ecology.ghislainv.fr/hSDM/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ghislainv/hSDM" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ZIP (Zero-Inflated Poisson) model</h1>
    
    <div class="hidden name"><code>hSDM.ZIP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>hSDM.ZIP</code> function can be used to model species
  distribution including different processes in a hierarchical Bayesian
  framework: a \(\mathcal{B}ernoulli\) suitability process
  (refering to various ecological variables explaining environmental
  suitability or not) and a \(\mathcal{P}oisson\) abundance
  process (refering to various ecological variables explaining the
  species abundance when the habitat is suitable). The <code>hSDM.ZIP</code>
  function calls a Gibbs sampler written in C code which uses a
  Metropolis algorithm to estimate the conditional posterior
  distribution of hierarchical model's parameters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hSDM.ZIP</span><span class="op">(</span><span class="va">counts</span>, <span class="va">suitability</span>, <span class="va">abundance</span>, <span class="va">data</span>,</span>
<span>suitability.pred<span class="op">=</span><span class="cn">NULL</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, mcmc <span class="op">=</span> <span class="fl">10000</span>, thin <span class="op">=</span> <span class="fl">10</span>,</span>
<span><span class="va">beta.start</span>, <span class="va">gamma.start</span>, mubeta <span class="op">=</span> <span class="fl">0</span>, Vbeta <span class="op">=</span> <span class="fl">1e+06</span>, mugamma <span class="op">=</span> <span class="fl">0</span>, Vgamma</span>
<span><span class="op">=</span> <span class="fl">1e+06</span>, seed <span class="op">=</span> <span class="fl">1234</span>, verbose <span class="op">=</span> <span class="fl">1</span>, save.p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>counts</dt>
<dd><p>A vector indicating the count for each observation.</p></dd>


  <dt>suitability</dt>
<dd><p>A one-sided formula of the form
    \(\sim x_1+...+x_p\) with \(p\) terms specifying the
    explicative variables for the suitability process.</p></dd>


  <dt>abundance</dt>
<dd><p>A one-sided formula of the form
    \(\sim w_1+...+w_q\) with \(q\) terms specifying the
    explicative variables for the abundance process.</p></dd>

  
  <dt>data</dt>
<dd><p>A data frame containing the model's variables.</p></dd>


  <dt>suitability.pred</dt>
<dd><p>An optional data frame in which to look for
    variables with which to predict. If NULL, the observations are
    used.</p></dd>


  <dt>burnin</dt>
<dd><p>The number of burnin iterations for the sampler.</p></dd>

    
  <dt>mcmc</dt>
<dd><p>The number of Gibbs iterations for the sampler. Total
    number of Gibbs iterations is equal to
    <code>burnin+mcmc</code>. <code>burnin+mcmc</code> must be divisible by 10 and
    superior or equal to 100 so that the progress bar can be displayed.</p></dd>

    
  <dt>thin</dt>
<dd><p>The thinning interval used in the simulation. The number
    of mcmc iterations must be divisible by this value.</p></dd>


  <dt>beta.start</dt>
<dd><p>Starting values for \(\beta\) parameters of
    the suitability process. This can either be a scalar or a
    \(p\)-length vector.</p></dd>


  <dt>gamma.start</dt>
<dd><p>Starting values for \(\beta\) parameters
    of the abundance process. This can either be a scalar or a
    \(q\)-length vector.</p></dd>

  
  <dt>mubeta</dt>
<dd><p>Means of the priors for the \(\beta\) parameters
  of the suitability process. <code>mubeta</code> must be either a scalar or a
  p-length vector. If <code>mubeta</code> takes a scalar value, then that value will
  serve as the prior mean for all of the betas. The default value is set
  to 0 for an uninformative prior.</p></dd>


  <dt>Vbeta</dt>
<dd><p>Variances of the Normal priors for the \(\beta\)
  parameters of the suitability process. <code>Vbeta</code> must be either a
  scalar or a p-length vector. If <code>Vbeta</code> takes a scalar value,
  then that value will serve as the prior variance for all of the
  betas. The default variance is large and set to 1.0E6 for an
  uninformative flat prior.</p></dd>


  <dt>mugamma</dt>
<dd><p>Means of the Normal priors for the \(\gamma\)
  parameters of the abundance process. <code>mugamma</code> must be either
  a scalar or a p-length vector. If <code>mugamma</code> takes a scalar value,
  then that value will serve as the prior mean for all of the
  gammas. The default value is set to 0 for an uninformative prior.</p></dd>


  <dt>Vgamma</dt>
<dd><p>Variances of the Normal priors for the
  \(\gamma\) parameters of the abundance
  process. <code>Vgamma</code> must be either a scalar or a p-length
  vector. If <code>Vgamma</code> takes a scalar value, then that value will
  serve as the prior variance for all of the gammas. The default
  variance is large and set to 1.0E6 for an uninformative flat prior.</p></dd>

 
  <dt>seed</dt>
<dd><p>The seed for the random number generator. Default set to
  1234.</p></dd>

  
  <dt>verbose</dt>
<dd><p>A switch (0,1) which determines whether or not the
    progress of the sampler is printed to the screen. Default is 1: a
    progress bar is printed, indicating the step (in %) reached by the
    Gibbs sampler.</p></dd>


  <dt>save.p</dt>
<dd><p>A switch (0,1) which determines whether or not the
    sampled values for predictions are saved. Default is 0: the
    posterior mean is computed and returned in the <code>prob.p.pred</code>
    vector. Be careful, setting <code>save.p</code> to 1 might require a large
    amount of memory.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>mcmc</dt>
<dd><p>An mcmc object that contains the posterior sample. This
    object can be summarized by functions provided by the coda
    package. The posterior sample of the deviance \(D\), with
    \(D=-2\log(\prod_i P(y_i,z_i|...))\), is also
    provided.</p></dd>


  <dt>prob.p.pred</dt>
<dd><p>If <code>save.p</code> is set to 0 (default),
    <code>prob.p.pred</code> is the predictive posterior mean of the
    probability associated to the suitability process for each
    prediction. If <code>save.p</code> is set to 1, <code>prob.p.pred</code> is an
    <code>mcmc</code> object with sampled values of the probability associated
    to the suitability process for each prediction.</p></dd>

  
  <dt>prob.p.latent</dt>
<dd><p>Predictive posterior mean of the probability
    associated to the suitability process for each observation.</p></dd>

  
  <dt>prob.q.latent</dt>
<dd><p>Predictive posterior mean of the probability
  associated to the abundance process for each observation.</p></dd>

  
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>The model integrates two processes, an ecological process associated
  to habitat suitability (habitat is suitable or not for the species)
  and an abundance process that takes into account ecological variables
  explaining the species abundance when the habitat is suitable.</p>
<p><b>Suitability process:</b>
  $$z_i \sim \mathcal{B}ernoulli(\theta_i)$$
  $$logit(\theta_i) = X_i \beta$$</p>   
<p><b>Abundance process:</b>
  $$y_i \sim \mathcal{P}oisson(z_i * \lambda_i)$$
  $$log(\lambda_i) = W_i \gamma$$</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Flores, O.; Rossi, V. and Mortier, F. (2009) Autocorrelation offsets
  zero-inflation in models of tropical saplings density. <em>Ecological
  Modelling</em>, 220, 1797-1809.</p>
<p>Gelfand, A. E.; Schmidt, A. M.; Wu, S.; Silander, J. A.; Latimer, A. and
  Rebelo, A. G. (2005) Modelling species diversity through species level
  hierarchical modelling. <em>Applied Statistics</em>, 54, 1-20.</p>  
<p>Latimer, A. M.; Wu, S. S.; Gelfand, A. E. and Silander, J. A. (2006) Building
  statistical models to analyze species distributions. <em>Ecological
    Applications</em>, 16, 33-50.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ghislain Vieilledent <a href="mailto:ghislain.vieilledent@cirad.fr">ghislain.vieilledent@cirad.fr</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/coda/man/plot.mcmc.html" class="external-link">plot.mcmc</a></code>, <code><a href="https://rdrr.io/pkg/coda/man/summary.mcmc.html" class="external-link">summary.mcmc</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==============================================</span></span></span>
<span class="r-in"><span><span class="co"># hSDM.ZIP()</span></span></span>
<span class="r-in"><span><span class="co"># Example with simulated data</span></span></span>
<span class="r-in"><span><span class="co">#==============================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#============</span></span></span>
<span class="r-in"><span><span class="co">#== Preambule</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ecology.ghislainv.fr/hSDM">hSDM</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==================</span></span></span>
<span class="r-in"><span><span class="co">#== Data simulation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set seed for repeatability</span></span></span>
<span class="r-in"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">1234</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number of observations</span></span></span>
<span class="r-in"><span><span class="va">nobs</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Target parameters</span></span></span>
<span class="r-in"><span><span class="va">beta.target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma.target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Uncomment if you want covariates on the abundance process</span></span></span>
<span class="r-in"><span><span class="co">## gamma.target &lt;- matrix(c(0.2,0.5,0.5),ncol=1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Covariates for "suitability" process</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">nobs</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">nobs</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nobs</span><span class="op">)</span>,<span class="va">X1</span>,<span class="va">X2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Covariates for "abundance" process</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nobs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Uncomment if you want covariates on the abundance process </span></span></span>
<span class="r-in"><span><span class="co">## set.seed(3*seed)</span></span></span>
<span class="r-in"><span><span class="co">## W1 &lt;- rnorm(n=nobs,0,1)</span></span></span>
<span class="r-in"><span><span class="co">## set.seed(4*seed)</span></span></span>
<span class="r-in"><span><span class="co">## W2 &lt;- rnorm(n=nobs,0,1)</span></span></span>
<span class="r-in"><span><span class="co">## W &lt;- cbind(rep(1,nobs),W1,W2)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#== Simulating latent variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Suitability</span></span></span>
<span class="r-in"><span><span class="va">logit.theta</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta.target</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="logit.html">inv.logit</a></span><span class="op">(</span><span class="va">logit.theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">nobs</span>,<span class="fl">1</span>,<span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Abundance</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log.lambda</span> <span class="op">&lt;-</span> <span class="va">W</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gamma.target</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log.lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">nobs</span>,<span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#== Simulating response variable</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">y.2</span><span class="op">*</span><span class="va">y.1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#== Data-set</span></span></span>
<span class="r-in"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X1</span>,<span class="va">X2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Uncomment if you want covariates on the abundance process </span></span></span>
<span class="r-in"><span><span class="co">## Data &lt;- data.frame(Y,X1,X2,W1,W2)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==================================</span></span></span>
<span class="r-in"><span><span class="co">#== ZIP model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod.hSDM.ZIP</span> <span class="op">&lt;-</span> <span class="fu">hSDM.ZIP</span><span class="op">(</span>counts<span class="op">=</span><span class="va">Data</span><span class="op">$</span><span class="va">Y</span>,</span></span>
<span class="r-in"><span>                         suitability<span class="op">=</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,</span></span>
<span class="r-in"><span>                         abundance<span class="op">=</span><span class="op">~</span><span class="fl">1</span>, <span class="co">#=~1+W1+W2 if covariates</span></span></span>
<span class="r-in"><span>                         data<span class="op">=</span><span class="va">Data</span>,</span></span>
<span class="r-in"><span>                         suitability.pred<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                         burnin<span class="op">=</span><span class="fl">1000</span>, mcmc<span class="op">=</span><span class="fl">1000</span>, thin<span class="op">=</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>                         beta.start<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         gamma.start<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         mubeta<span class="op">=</span><span class="fl">0</span>, Vbeta<span class="op">=</span><span class="fl">1.0E6</span>,</span></span>
<span class="r-in"><span>                         mugamma<span class="op">=</span><span class="fl">0</span>, Vgamma<span class="op">=</span><span class="fl">1.0E6</span>,</span></span>
<span class="r-in"><span>                         seed<span class="op">=</span><span class="fl">1234</span>, verbose<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                         save.p<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==========</span></span></span>
<span class="r-in"><span><span class="co">#== Outputs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"Posteriors_hSDM.ZIP.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod.hSDM.ZIP</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.hSDM.ZIP</span><span class="op">$</span><span class="va">prob.p.latent</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.hSDM.ZIP</span><span class="op">$</span><span class="va">prob.q.latent</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.hSDM.ZIP</span><span class="op">$</span><span class="va">prob.p.pred</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://ecology.ghislainv.fr" class="external-link">Ghislain Vieilledent</a>, <a href="https://www.cirad.fr" class="external-link"><img src="https://ecology.ghislainv.fr/hSDM/articles/logos/logo-cirad.png"></a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

