<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Binomial logistic regression model with CAR process — hSDM.binomial.iCAR • hSDM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Binomial logistic regression model with CAR process — hSDM.binomial.iCAR"><meta property="og:description" content="The hSDM.binomial.iCAR function performs a Binomial
  logistic regression model in a hierarchical Bayesian framework. The
  suitability process includes a spatial correlation process. The
  spatial correlation is modelled using an intrinsic CAR model. The
  hSDM.binomial.iCAR function calls a Gibbs sampler written in C
  code which uses an adaptive Metropolis algorithm to estimate the
  conditional posterior distribution of hierarchical model's
  parameters."><meta property="og:image" content="https://ecology.ghislainv.fr/hSDM/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ghislainv/hSDM" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Binomial logistic regression model with CAR process</h1>
    
    <div class="hidden name"><code>hSDM.binomial.iCAR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>hSDM.binomial.iCAR</code> function performs a Binomial
  logistic regression model in a hierarchical Bayesian framework. The
  suitability process includes a spatial correlation process. The
  spatial correlation is modelled using an intrinsic CAR model. The
  <code>hSDM.binomial.iCAR</code> function calls a Gibbs sampler written in C
  code which uses an adaptive Metropolis algorithm to estimate the
  conditional posterior distribution of hierarchical model's
  parameters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hSDM.binomial.iCAR</span><span class="op">(</span><span class="va">presences</span>, <span class="va">trials</span>, <span class="va">suitability</span>,</span>
<span><span class="va">spatial.entity</span>, <span class="va">data</span>, <span class="va">n.neighbors</span>, <span class="va">neighbors</span>, suitability.pred<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>spatial.entity.pred<span class="op">=</span><span class="cn">NULL</span>, burnin <span class="op">=</span> <span class="fl">5000</span>, mcmc <span class="op">=</span> <span class="fl">10000</span>, thin <span class="op">=</span> <span class="fl">10</span>,</span>
<span><span class="va">beta.start</span>, <span class="va">Vrho.start</span>, mubeta <span class="op">=</span> <span class="fl">0</span>, Vbeta <span class="op">=</span> <span class="fl">1e+06</span>, priorVrho <span class="op">=</span></span>
<span><span class="st">"1/Gamma"</span>, shape <span class="op">=</span> <span class="fl">0.5</span>, rate <span class="op">=</span> <span class="fl">0.0005</span>, Vrho.max<span class="op">=</span><span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>verbose <span class="op">=</span> <span class="fl">1</span>, save.rho <span class="op">=</span> <span class="fl">0</span>, save.p <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>presences</dt>
<dd><p>A vector indicating the number of successes (or
    presences) for each observation.</p></dd>


  <dt>trials</dt>
<dd><p>A vector indicating the number of trials for each
    observation. \(t_i\) should be superior to zero and superior or
    equal to \(y_i\), the number of successes for observation \(i\).</p></dd>


  <dt>suitability</dt>
<dd><p>A one-sided formula of the form
    \(\sim x_1+...+x_p\) with \(p\) terms specifying the
    explicative variables for the suitability process.</p></dd>


  <dt>spatial.entity</dt>
<dd><p>A vector indicating the spatial entity
    identifier (from one to the total number of entities) for each
    observation. Several observations can occur in one spatial entity. A
    spatial entity can be a raster cell for example.</p></dd>


  <dt>data</dt>
<dd><p>A data frame containing the model's variables.</p></dd>


  <dt>n.neighbors</dt>
<dd><p>A vector of integers that indicates the number of
    neighbors (adjacent entities) of each spatial
    entity. <code>length(n.neighbors)</code> indicates the total number of
    spatial entities.</p></dd>

  
  <dt>neighbors</dt>
<dd><p>A vector of integers indicating the neighbors
    (adjacent entities) of each spatial entity. Must be of the form
    c(neighbors of entity 1, neighbors of entity 2, ... , neighbors of
    the last entity). Length of the <code>neighbors</code> vector should be
    equal to <code>sum(n.neighbors)</code>.</p></dd>


  <dt>suitability.pred</dt>
<dd><p>An optional data frame in which to look for
    variables with which to predict. If NULL, the observations are
    used.</p></dd>


  <dt>spatial.entity.pred</dt>
<dd><p>An optional vector indicating the spatial
    entity identifier (from one to the total number of entities) for
    predictions. If NULL, the vector <code>spatial.entity</code> for
    observations is used.</p></dd>


  <dt>burnin</dt>
<dd><p>The number of burnin iterations for the sampler.</p></dd>

    
  <dt>mcmc</dt>
<dd><p>The number of Gibbs iterations for the sampler. Total
    number of Gibbs iterations is equal to
    <code>burnin+mcmc</code>. <code>burnin+mcmc</code> must be divisible by 10 and
    superior or equal to 100 so that the progress bar can be displayed.</p></dd>

    
  <dt>thin</dt>
<dd><p>The thinning interval used in the simulation. The number
    of mcmc iterations must be divisible by this value.</p></dd>


  <dt>beta.start</dt>
<dd><p>Starting values for \(\beta\) parameters of
    the suitability process. This can either be a scalar or a
    \(p\)-length vector.</p></dd>

  
  <dt>Vrho.start</dt>
<dd><p>Positive scalar indicating the starting value for the
    variance of the spatial random effects.</p></dd>


  <dt>mubeta</dt>
<dd><p>Means of the priors for the \(\beta\) parameters
  of the suitability process. <code>mubeta</code> must be either a scalar or a
  p-length vector. If <code>mubeta</code> takes a scalar value, then that value will
  serve as the prior mean for all of the betas. The default value is set
  to 0 for an uninformative prior.</p></dd>


  <dt>Vbeta</dt>
<dd><p>Variances of the Normal priors for the \(\beta\)
  parameters of the suitability process. <code>Vbeta</code> must be either a
  scalar or a p-length vector. If <code>Vbeta</code> takes a scalar value,
  then that value will serve as the prior variance for all of the
  betas. The default variance is large and set to 1.0E6 for an
  uninformative flat prior.</p></dd>


  <dt>priorVrho</dt>
<dd><p>Type of prior for the variance of the spatial random
  effects. Can be set to a fixed positive scalar, or to an inverse-gamma
  distribution ("1/Gamma") with parameters <code>shape</code> and <code>rate</code>,
  or to a uniform distribution ("Uniform") on the interval
  [0,<code>Vrho.max</code>]. Default set to "1/Gamma".</p></dd>


  <dt>shape</dt>
<dd><p>The shape parameter for the Gamma prior on the precision
  of the spatial random effects. Default value is <code>shape=0.5</code> for
  uninformative prior.</p></dd>


  <dt>rate</dt>
<dd><p>The rate (1/scale) parameter for the Gamma prior on the
    precision of the spatial random effects. Default value is
    <code>rate=0.0005</code> for uninformative prior.</p></dd>


  <dt>Vrho.max</dt>
<dd><p>Upper bound for the uniform prior of the spatial
    random effect variance. Default set to 1000.</p></dd>

 
  <dt>seed</dt>
<dd><p>The seed for the random number generator. Default set to
  1234.</p></dd>

  
  <dt>verbose</dt>
<dd><p>A switch (0,1) which determines whether or not the
    progress of the sampler is printed to the screen. Default is 1: a
    progress bar is printed, indicating the step (in %) reached by the
    Gibbs sampler.</p></dd>


  <dt>save.rho</dt>
<dd><p>A switch (0,1) which determines whether or not the
    sampled values for rhos are saved. Default is 0: the posterior mean
    is computed and returned in the <code>rho.pred</code> vector. Be careful,
    setting <code>save.rho</code> to 1 might require a large amount of
    memory.</p></dd>


  <dt>save.p</dt>
<dd><p>A switch (0,1) which determines whether or not the
    sampled values for predictions are saved. Default is 0: the
    posterior mean is computed and returned in the <code>theta.pred</code>
    vector. Be careful, setting <code>save.p</code> to 1 might require a large
    amount of memory.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>mcmc</dt>
<dd><p>An mcmc object that contains the posterior sample. This
    object can be summarized by functions provided by the coda
    package. The posterior sample of the deviance \(D\), with
    \(D=-2\log(\prod_i P(y_i|...))\), is
    also provided.</p></dd>


  <dt>rho.pred</dt>
<dd><p>If <code>save.rho</code> is set to 0 (default),
    <code>rho.pred</code> is the predictive posterior mean of the spatial
    random effect associated to each spatial entity. If <code>save.rho</code> is
    set to 1, <code>rho.pred</code> is an <code>mcmc</code> object with sampled
    values for each spatial random effect associated to each spatial
    entity.</p></dd>


  <dt>theta.pred</dt>
<dd><p>If <code>save.p</code> is set to 0 (default),
    <code>theta.pred</code> is the predictive posterior mean of the
    probability associated to the suitability process for each
    prediction. If <code>save.p</code> is set to 1, <code>theta.pred</code> is an
    <code>mcmc</code> object with sampled values of the probability associated
    to the suitability process for each prediction.</p></dd>

  
  <dt>theta.latent</dt>
<dd><p>Predictive posterior mean of the probability
    associated to the suitability process for each observation.</p></dd>

  
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>We model an ecological process where the presence or absence of the
  species is explained by habitat suitability. The ecological process
  includes an intrinsic conditional autoregressive (iCAR) model for
  spatial autocorrelation between observations, assuming that the
  probability of presence of the species at one site depends on the
  probability of presence of the species on neighboring sites.</p>
<p><b>Ecological process:</b>
  $$y_i \sim \mathcal{B}inomial(\theta_i,t_i)$$
  $$logit(\theta_i) = X_i \beta + \rho_{j(i)}$$
  \(\rho_j\): spatial random effect</p>  
<p>\(j(i)\): index of the spatial entity for observation \(i\).</p>  
<p><b>Spatial autocorrelation:</b></p>  
<p>An intrinsic conditional autoregressive model (iCAR) is assumed:
  $$\rho_j \sim \mathcal{N}ormal(\mu_j,V_{\rho} / n_j)$$
  \(\mu_j\): mean of \(\rho_{j'}\) in the
  neighborhood of \(j\).</p>  
<p>\(V_{\rho}\): variance of the spatial random effects.</p>  
<p>\(n_j\): number of neighbors for spatial entity \(j\).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Gelfand, A. E.; Schmidt, A. M.; Wu, S.; Silander, J. A.; Latimer, A. and
  Rebelo, A. G. (2005) Modelling species diversity through species level
  hierarchical modelling. <em>Applied Statistics</em>, 54, 1-20.</p>   
<p>Latimer, A. M.; Wu, S. S.; Gelfand, A. E. and Silander, J. A. (2006) Building
  statistical models to analyze species distributions. <em>Ecological
    Applications</em>, 16, 33-50.</p>
<p>Lichstein, J. W.; Simons, T. R.; Shriner, S. A. &amp; Franzreb,
  K. E. (2002) Spatial autocorrelation and autoregressive models in ecology
  <em>Ecological Monographs</em>, 72, 445-463.</p>
<p>Diez, J. M. &amp; Pulliam, H. R. (2007) Hierarchical analysis of species
  distributions and abundance across environmental gradients
  <em>Ecology</em>, 88, 3144-3152.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ghislain Vieilledent <a href="mailto:ghislain.vieilledent@cirad.fr">ghislain.vieilledent@cirad.fr</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/coda/man/plot.mcmc.html" class="external-link">plot.mcmc</a></code>, <code><a href="https://rdrr.io/pkg/coda/man/summary.mcmc.html" class="external-link">summary.mcmc</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==============================================</span></span></span>
<span class="r-in"><span><span class="co"># hSDM.binomial.iCAR()</span></span></span>
<span class="r-in"><span><span class="co"># Example with simulated data</span></span></span>
<span class="r-in"><span><span class="co">#==============================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#=================</span></span></span>
<span class="r-in"><span><span class="co">#== Load libraries                          </span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ecology.ghislainv.fr/hSDM">hSDM</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#===================================</span></span></span>
<span class="r-in"><span><span class="co">#== Multivariate normal distribution</span></span></span>
<span class="r-in"><span><span class="va">rmvn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="va">seed</span><span class="op">=</span><span class="fl">1234</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Dimension problem!"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>,ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">D</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mu</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==================</span></span></span>
<span class="r-in"><span><span class="co">#== Data simulation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Set seed for repeatability</span></span></span>
<span class="r-in"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">1234</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Landscape</span></span></span>
<span class="r-in"><span><span class="va">xLand</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">yLand</span> <span class="op">&lt;-</span> <span class="fl">30</span> </span></span>
<span class="r-in"><span><span class="va">Landscape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="va">xLand</span>,nrow<span class="op">=</span><span class="va">yLand</span>,crs<span class="op">=</span><span class="st">'+proj=utm +zone=1'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Landscape</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="va">Landscape</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">xLand</span>,<span class="fl">0</span>,<span class="va">yLand</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">Landscape</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ncells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">Landscape</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Neighbors</span></span></span>
<span class="r-in"><span><span class="va">neighbors.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/adjacent.html" class="external-link">adjacent</a></span><span class="op">(</span><span class="va">Landscape</span>, cells<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">ncells</span><span class="op">)</span>, directions<span class="op">=</span><span class="fl">8</span>, pairs<span class="op">=</span><span class="cn">TRUE</span>, sorted<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n.neighbors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">neighbors.mat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">adj</span> <span class="op">&lt;-</span> <span class="va">neighbors.mat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Generate symmetric adjacency matrix, A</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ncells</span>,<span class="va">ncells</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">index.start</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ncells</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">index.end</span> <span class="op">&lt;-</span> <span class="va">index.start</span><span class="op">+</span><span class="va">n.neighbors</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">A</span><span class="op">[</span><span class="va">i</span>,<span class="va">adj</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">index.start</span><span class="op">:</span><span class="va">index.end</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">index.start</span> <span class="op">&lt;-</span> <span class="va">index.end</span><span class="op">+</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Spatial effects</span></span></span>
<span class="r-in"><span><span class="va">Vrho.target</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">1</span>  <span class="co"># Spatial dependence parameter = 1 for intrinsic CAR</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">n.neighbors</span><span class="op">)</span><span class="op">-</span><span class="va">d</span><span class="op">*</span><span class="va">A</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">.0001</span>,<span class="va">ncells</span><span class="op">)</span> <span class="co"># Add small constant to make Q non-singular</span></span></span>
<span class="r-in"><span><span class="va">covrho</span> <span class="op">&lt;-</span> <span class="va">Vrho.target</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span> <span class="co"># Covariance of rhos</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">rmvn</span><span class="op">(</span><span class="fl">1</span>,mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">ncells</span><span class="op">)</span>,V<span class="op">=</span><span class="va">covrho</span>,seed<span class="op">=</span><span class="va">seed</span><span class="op">)</span><span class="op">)</span> <span class="co"># Spatial Random Effects</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">rho</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="co"># Centering rhos on zero</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Raster and plot spatial effects</span></span></span>
<span class="r-in"><span><span class="va">r.rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterFromXYZ.html" class="external-link">rasterFromXYZ</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">coords</span>,<span class="va">rho</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r.rho</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Sample the observation sites in the landscape</span></span></span>
<span class="r-in"><span><span class="va">nsite</span> <span class="op">&lt;-</span> <span class="fl">250</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x.coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nsite</span>,<span class="fl">0</span>,<span class="va">xLand</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y.coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nsite</span>,<span class="fl">0</span>,<span class="va">yLand</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sites.sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span>coords<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x.coord</span>,<span class="va">y.coord</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">Landscape</span>,<span class="va">sites.sp</span>,cell<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Number of visits associated to each observation point</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">visits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">nsite</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">visits</span><span class="op">[</span><span class="va">visits</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Ecological process (suitability)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsite</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsite</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">nsite</span><span class="op">)</span>,<span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta.target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">logit.theta</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta.target</span> <span class="op">+</span> <span class="va">rho</span><span class="op">[</span><span class="va">cells</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="logit.html">inv.logit</a></span><span class="op">(</span><span class="va">logit.theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">nsite</span>,<span class="va">visits</span>,<span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Relative importance of spatial random effects</span></span></span>
<span class="r-in"><span><span class="va">RImp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rho</span><span class="op">[</span><span class="va">cells</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta.target</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RImp</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Data-sets</span></span></span>
<span class="r-in"><span><span class="va">data.obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">visits</span>,<span class="va">x1</span>,<span class="va">x2</span>,cell<span class="op">=</span><span class="va">cells</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==================================</span></span></span>
<span class="r-in"><span><span class="co">#== Site-occupancy model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Start the clock</span></span></span>
<span class="r-in"><span><span class="va">mod.hSDM.binomial.iCAR</span> <span class="op">&lt;-</span> <span class="fu">hSDM.binomial.iCAR</span><span class="op">(</span>presences<span class="op">=</span><span class="va">data.obs</span><span class="op">$</span><span class="va">Y</span>,</span></span>
<span class="r-in"><span>                                               trials<span class="op">=</span><span class="va">data.obs</span><span class="op">$</span><span class="va">visits</span>,</span></span>
<span class="r-in"><span>                                               suitability<span class="op">=</span><span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span>,</span></span>
<span class="r-in"><span>                                               spatial.entity<span class="op">=</span><span class="va">data.obs</span><span class="op">$</span><span class="va">cell</span>,</span></span>
<span class="r-in"><span>                                               data<span class="op">=</span><span class="va">data.obs</span>,</span></span>
<span class="r-in"><span>                                               n.neighbors<span class="op">=</span><span class="va">n.neighbors</span>,</span></span>
<span class="r-in"><span>                                               neighbors<span class="op">=</span><span class="va">adj</span>,</span></span>
<span class="r-in"><span>                                               suitability.pred<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                                               spatial.entity.pred<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                                               burnin<span class="op">=</span><span class="fl">5000</span>, mcmc<span class="op">=</span><span class="fl">5000</span>, thin<span class="op">=</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>                                               beta.start<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                               Vrho.start<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                               mubeta<span class="op">=</span><span class="fl">0</span>, Vbeta<span class="op">=</span><span class="fl">1.0E6</span>,</span></span>
<span class="r-in"><span>                                               priorVrho<span class="op">=</span><span class="st">"1/Gamma"</span>,</span></span>
<span class="r-in"><span>                                               shape<span class="op">=</span><span class="fl">0.5</span>, rate<span class="op">=</span><span class="fl">0.0005</span>,</span></span>
<span class="r-in"><span>                                               seed<span class="op">=</span><span class="fl">1234</span>, verbose<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                               save.rho<span class="op">=</span><span class="fl">1</span>, save.p<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Time.hSDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,<span class="va">Start</span>,units<span class="op">=</span><span class="st">"sec"</span><span class="op">)</span> <span class="co"># Time difference</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Computation time</span></span></span>
<span class="r-in"><span><span class="va">Time.hSDM</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==========</span></span></span>
<span class="r-in"><span><span class="co">#== Outputs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Parameter estimates </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.hSDM.binomial.iCAR</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span><span class="st">"Posteriors_hSDM.binomial.iCAR.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod.hSDM.binomial.iCAR</span><span class="op">$</span><span class="va">mcmc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.hSDM.binomial.iCAR</span><span class="op">$</span><span class="va">theta.latent</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.hSDM.binomial.iCAR</span><span class="op">$</span><span class="va">theta.pred</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"Pred-Init.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">theta</span>,<span class="va">mod.hSDM.binomial.iCAR</span><span class="op">$</span><span class="va">theta.pred</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#= Summary plots for spatial random effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rho.pred</span></span></span>
<span class="r-in"><span><span class="va">rho.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mod.hSDM.binomial.iCAR</span><span class="op">$</span><span class="va">rho.pred</span>,<span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r.rho.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rasterFromXYZ.html" class="external-link">rasterFromXYZ</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">coords</span>,<span class="va">rho.pred</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"Summary_hSDM.binomial.iCAR.pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># rho target</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r.rho</span>, main<span class="op">=</span><span class="st">"rho target"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sites.sp</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># rho estimated</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r.rho.pred</span>, main<span class="op">=</span><span class="st">"rho estimated"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># correlation and "shrinkage"</span></span></span>
<span class="r-in"><span><span class="va">Levels.cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rho</span><span class="op">[</span><span class="op">-</span><span class="va">Levels.cells</span><span class="op">]</span>,<span class="va">rho.pred</span><span class="op">[</span><span class="op">-</span><span class="va">Levels.cells</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab<span class="op">=</span><span class="st">"rho target"</span>,</span></span>
<span class="r-in"><span>     ylab<span class="op">=</span><span class="st">"rho estimated"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">rho</span><span class="op">[</span><span class="va">Levels.cells</span><span class="op">]</span>,<span class="va">rho.pred</span><span class="op">[</span><span class="va">Levels.cells</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">3</span>,y<span class="op">=</span><span class="fl">4</span>,legend<span class="op">=</span><span class="st">"Visited cells"</span>,col<span class="op">=</span><span class="st">"blue"</span>,pch<span class="op">=</span><span class="fl">16</span>,bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://ecology.ghislainv.fr" class="external-link">Ghislain Vieilledent</a>, <a href="https://www.cirad.fr" class="external-link"><img src="https://ecology.ghislainv.fr/hSDM/articles/logos/logo-cirad.png"></a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

